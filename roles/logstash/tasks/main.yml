---
#
# Installing logstash
#

# Installing Elasticsearch

- name: Install logstash
  apt:
   name: logstash
   update_cache: yes

- name: Akamai Logfile Directory Creation
  file:
    path: "/home/akamailogs"
    state: directory
    mode: 0755
    group: alanc
    owner: alanc

- name: Set up Akamai Logfile Processing
  copy:
    src: roles/logstash/files/akamai.conf
    dest: /etc/logstash/conf.d/akamai.conf
   
# # Update Elasticsearch config file to allow access (to secure Elasticsearch, bind to 'localhost'). 

# - name: Updating the config file to allow outside access
#   lineinfile:
#    destfile: /etc/elasticsearch/elasticsearch.yml
#    regexp: 'network.host:'
#    line: 'network.host: 0.0.0.0'
 
# # Update Elasticsearch port in config file 

# - name: Updating the port in config file 
#   lineinfile:
#    destfile: /etc/elasticsearch/elasticsearch.yml
#    regexp: 'http.port:'
#    line: 'http.port: 9200'
 
# # Start Elasticsearch
# - name: Starting Elasticsearch
#   service:
#    name: elasticsearch
#    state: started
    
